---
title: "Russian comparative function words"
author: "Kirill Konovalov, Petr Filchenkov"
date: "12/06/2020"
output:
  pdf_document: default
  html_notebook: default
  html_document: default
---


Предмет исследования: распределение ...   
Материал исследования: примеры из Национального Корпуса Русского Языка.

Факторы, которые рассматриваются как возможно влияющие на выбор слова (независимые переменнные):

- регистр речи (письменный, устный);   
- жанр текста (художественный, нехудожественный);   
- часть речи слова, стоящая слева от анализируемого;  
- часть речи слова, стоящая справа от анализируемого;   
- время создания текста (по десятилетиям). 

Нулевой гипотезой является предположение о том, что ... 



В результате получено ... .  ... . Данные представлены в файле ___.csv и проиллюстрированы в графиках.

Hypotheses to be tested:
"будто", "словно", "а-ля", "аки", "подобно"
"будто" and "словно" occur more often in bellse-lettres texts (binominal test for belles-lettres subcorpus, where "будто" is 1, and other words are 0. binominal test for belles-lettres subcorpus, where "словно" is 1, and other words are 0. )
"как", "подобно" have even distribution in texts of all genres (just look at the data plot)
"а-ля" tend to occur more often in the past ()

```{r}
#install.packages("tidyverse")
library(tidyverse)
```

```{r}
urlfile="https://raw.githubusercontent.com/a-la-r/data/master/df_250_wr.csv"
full_data<-read.csv(url(urlfile), sep = ";", encoding='UTF-8')
data<- subset(full_data, select = c(Center, Created, Type, Left_context_POS, Right_context_POS))
```

```{r}
head(data)
```

```{r}
summary(data)
```

###Data Visualization


```{r}
data %>%
  ggplot(aes(Type, fill = Type)) + 
  geom_bar() +
  theme_bw() +
  facet_wrap(~Center) +
  theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank())
```

```{r}
data %>%
  ggplot(aes(Created, fill = Center)) + 
  geom_bar() +
  theme_bw() +
  facet_wrap(~Center) 
 # theme(axis.text.x=element_blank(),
       # axis.ticks.x=element_blank())
```

```{r}
data %>%
  ggplot(aes(Left_context_POS, fill = Left_context_POS)) + 
  geom_bar() +
  theme_bw() +
  facet_wrap(~Center) +
  theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank())
```

```{r}
data %>%
  ggplot(aes(Right_context_POS, fill = Right_context_POS)) + 
  geom_bar() +
  theme_bw() +
  facet_wrap(~Center) +
  theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank())
```


###Binomial tests
####Type
```{r}
budto_slovno <- data
budto_slovno$Center <- gsub("будто", 1, budto_slovno$Center)
budto_slovno$Center <- gsub("словно", 1, budto_slovno$Center)
budto_slovno$Center <- gsub("аки", 1, budto_slovno$Center)
budto_slovno$Center <- gsub("а-ля", 0, budto_slovno$Center)
budto_slovno$Center <- gsub("как", 0, budto_slovno$Center)
budto_slovno$Center <- gsub("подобно", 0, budto_slovno$Center)

belles_lettres2 <- budto_slovno[budto_slovno$Type=="художественный",]

total <- nrow(belles_lettres2)
nbudto_slovno <- nrow(belles_lettres2[belles_lettres2$Center==1,]) # number of successes

binom.test(nbudto_slovno, total)
```


```{r}
ala_coll <- data
ala_coll$Center <- gsub("будто", 0, ala_coll$Center)
ala_coll$Center <- gsub("словно", 0, ala_coll$Center)
ala_coll$Center <- gsub("аки", 0, ala_coll$Center)
ala_coll$Center <- gsub("а-ля", 1, ala_coll$Center)
ala_coll$Center <- gsub("как", 0, ala_coll$Center)
ala_coll$Center <- gsub("подобно", 0, ala_coll$Center)

colloquial <- ala_coll[ala_coll$Type=="разговорный",]

total <- nrow(colloquial)
nbudto_slovno <- nrow(colloquial[colloquial$Center==1,]) # number of successes

binom.test(nbudto_slovno, total)
```

####"Аки" before XX

```{r}
aki <- data
aki$Center <- gsub("будто", 0, aki$Center)
aki$Center <- gsub("словно", 0, aki$Center)
aki$Center <- gsub("аки", 1, aki$Center)
aki$Center <- gsub("а-ля", 0, aki$Center)
aki$Center <- gsub("как", 0, aki$Center)
aki$Center <- gsub("подобно", 0, aki$Center)

old_texts <- aki[aki$Created<=1900,]
total <- nrow(old_texts)
naki <- nrow(old_texts[old_texts$Center==1,]) # number of successes

binom.test(naki, total)
```

```{r}
new_texts <- aki[aki$Created>=1900,]
total <- nrow(new_texts)
naki <- nrow(new_texts[new_texts$Right_context_POS==1,]) 

binom.test(naki, total)
```

#Right Context

####Nouns after comparative words before XX
```{r}
nouns <- data
nouns$Right_context_POS <- gsub("NOUN", 1, nouns$Right_context_POS)
nouns$Right_context_POS[nouns$Right_context_POS != 1] <- 0

old_texts <- nouns[nouns$Created<=1900,]
total <- nrow(old_texts)
nnouns <- nrow(old_texts[old_texts$Right_context_POS==1,]) 

binom.test(nnouns, total)
```
####"Nouns after comparative words" in XX-XXI 
```{r}
new_texts <- nouns[nouns$Created>=1900,]
total <- nrow(new_texts)
nnouns <- nrow(new_texts[new_texts$Right_context_POS==1,]) 

binom.test(nnouns, total)
```
####Auxiliary words after comparative words before XX
```{r}
aux <- data
aux$Right_context_POS <- gsub("AUX", 1, aux$Right_context_POS)
aux$Right_context_POS[aux$Right_context_POS != 1] <- 0

old_texts <- aux[aux$Created<=1900,]
total <- nrow(old_texts)
naux <- nrow(old_texts[old_texts$Right_context_POS==1,]) 

binom.test(naux, total)
```
####Auxiliary words after comparative words in XX-XXI

```{r}
new_texts <- aux[aux$Created>=1900,]
total <- nrow(new_texts)
naux <- nrow(new_texts[new_texts$Right_context_POS==1,]) 

binom.test(naux, total)
```

####Adjectives after comparative words before XX

```{r}
adj <- data
adj$Right_context_POS <- gsub("ADJ", 1, adj$Right_context_POS)
adj$Right_context_POS[adj$Right_context_POS != 1] <- 0

old_texts <- adj[adj$Created<=1900,]
total <- nrow(old_texts)
nadj <- nrow(old_texts[old_texts$Right_context_POS==1,]) 

binom.test(nadj, total)
```

####Adjectives after comparative words in XX-XXI

```{r}
new_texts <- adj[adj$Created>=1900,]
total <- nrow(new_texts)
nadj <- nrow(new_texts[new_texts$Right_context_POS==1,]) 

binom.test(nadj, total)
```


###Left context

####Comparative words after nouns before XX
```{r}
nouns <- data
nouns$Left_context_POS <- gsub("NOUN", 1, nouns$Left_context_POS)
nouns$Left_context_POS[nouns$Left_context_POS != 1] <- 0

old_texts <- nouns[nouns$Created<=1900,]
total <- nrow(old_texts)
nnouns <- nrow(old_texts[old_texts$Left_context_POS==1,]) 

binom.test(nnouns, total)
```
####Comparative words after nouns in XX-XXI 
```{r}
new_texts <- nouns[nouns$Created>=1900,]
total <- nrow(new_texts)
nnouns <- nrow(new_texts[new_texts$Left_context_POS==1,]) 

binom.test(nnouns, total)
```
####Comparative words after auxiliary words before XX
```{r}
aux <- data
aux$Left_context_POS <- gsub("AUX", 1, aux$Left_context_POS)
aux$Left_context_POS[aux$Left_context_POS != 1] <- 0

old_texts <- aux[aux$Created<=1900,]
total <- nrow(old_texts)
naux <- nrow(old_texts[old_texts$Left_context_POS==1,]) 

binom.test(naux, total)
```
####Comparative words after auxiliary words in XX-XXI

```{r}
new_texts <- aux[aux$Created>=1900,]
total <- nrow(new_texts)
naux <- nrow(new_texts[new_texts$Left_context_POS==1,]) 

binom.test(naux, total)
```

####Comparative words after adjectives before XX

```{r}
adj <- data
adj$Left_context_POS <- gsub("ADJ", 1, adj$Left_context_POS)
adj$Left_context_POS[adj$Left_context_POS != 1] <- 0

old_texts <- adj[adj$Created<=1900,]
total <- nrow(old_texts)
nadj <- nrow(old_texts[old_texts$Left_context_POS==1,]) 

binom.test(nadj, total)
```

####Comparative words after adjectives in XX-XXI

```{r}
new_texts <- adj[adj$Created>=1900,]
total <- nrow(new_texts)
nadj <- nrow(new_texts[new_texts$Left_context_POS==1,]) 

binom.test(nadj, total)
```


###Chi-squared test

Comparative words and century

```{r}
data <- data %>% mutate(Century = ifelse(Created >= 1900, "XX-XXI cent", "before XX cent."))

tab <- table(data$Center, data$Century)

prop.table(tab)

chisq.test(data$Center, data$Century)
```
Comparative words and functional style
```{r}

chisq.test(data$Center, data$Type)

```
Comparative words and right context
```{r}
chisq.test(data$Center, data$Left_context_POS)

```
Comparative words and left context
```{r}

chisq.test(data$Center, data$Left_context_POS)

```

###Linear Regression

```{r}

years_distr <- t(table(data$Center, data$Created))
years_distr <- add_rownames(as.data.frame.matrix(years_distr)) 
colnames(years_distr) <-c("year", "ala", "aki", "budto", "kak", "podobno", "slovno")
years_distr$year <- as.numeric(years_distr$year)

years_distr

```
```{r}
fit1 <- lm(ala ~ year, data = years_distr)
summary(fit1)
```

```{r}
fit2 <- lm(aki ~ year, data = years_distr)
summary(fit2)
```


```{r}
fit3 <- lm(budto ~ year, data = years_distr)
summary(fit3)
```


```{r}
fit4 <- lm(kak ~ year, data = years_distr)
summary(fit4)
```

```{r}
fit5 <- lm(podobno ~ year, data = years_distr)
summary(fit5)
```


```{r}
fit6 <- lm(slovno ~ year, data = years_distr)
summary(fit6)
```








```{r}
p <- ggplot(data = years_distr, aes(x = year, y = kak)) + 
  geom_point() +
  labs(y = "'как' occurrences",
       x = "year",
       title = "Distribution of 'как'") +
  geom_smooth(method=lm)
p
```

```{r}
p <- ggplot(data = years_distr, aes(x = year, y = ala)) + 
  geom_point() +
  labs(x = "year",
       y = "'а-ля' occurrences",
       title = "Distribution of 'а-ля'") +
  geom_smooth(method=lm)
p
```