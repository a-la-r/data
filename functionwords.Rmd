---
title: 'Russian comparative function words'
author: "Kirill Konovalov, Petr Filchenkov"
date: "12/06/2020"
output:
  html_notebook: default
  html_document: default
---

Предмет исследования: распределение ...   
Материал исследования: примеры из Национального Корпуса Русского Языка.

Факторы, которые рассматриваются как возможно влияющие на выбор слова (независимые переменнные):

- регистр речи (письменный, устный);   
- жанр текста (художественный, нехудожественный);   
- часть речи слова, стоящая слева от анализируемого;  
- часть речи слова, стоящая справа от анализируемого;   
- время создания текста (по десятилетиям). 

Нулевой гипотезой является предположение о том, что ... 



В результате получено ... .  ... . Данные представлены в файле ___.csv и проиллюстрированы в графиках.

Hypotheses to be tested:
"будто", "словно", "а-ля", "аки", "подобно"
"будто" and "словно" occur more often in bellse-lettres texts (binominal test for belles-lettres subcorpus, where "будто" is 1, and other words are 0. binominal test for belles-lettres subcorpus, where "словно" is 1, and other words are 0. )
"как", "подобно" have even distribution in texts of all genres (just look at the data plot)
"а-ля" and "аки" tend to occur more often in the past ()

```{r}
#install.packages("tidyverse")
library("tidyverse")
```

```{r}
urlfile="https://raw.githubusercontent.com/a-la-r/data/master/df_250_wr.csv"
data<-read.csv(url(urlfile), sep = ";")
```

```{r}
head(data)
```

```{r}
summary(data)
```

###Визуализация данных

```{r}
data %>%
  ggplot(aes(Sphere, fill = Sphere)) + 
  geom_bar() +
  theme_bw() + 
  facet_wrap(~Center) +
  theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank())
```

```{r}
data %>%
  ggplot(aes(Type, fill = Type)) + 
  geom_bar() +
  theme_bw() +
  facet_wrap(~Center) +
  theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank())
```

```{r}
data %>%
  ggplot(aes(Created, fill = Center)) + 
  geom_bar() +
  theme_bw() +
  facet_wrap(~Center) 
 # theme(axis.text.x=element_blank(),
       # axis.ticks.x=element_blank())
```

```{r}
data %>%
  ggplot(aes(Left_context_POS, fill = Left_context_POS)) + 
  geom_bar() +
  theme_bw() +
  facet_wrap(~Center) +
  theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank())
```

```{r}
data %>%
  ggplot(aes(Right_context_POS, fill = Right_context_POS)) + 
  geom_bar() +
  theme_bw() +
  facet_wrap(~Center) +
  theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank())
```

###Предобработка датасета

```{r}
cols <- c('Left.context', 'Center', 'Right.context', 'Created', 'Sphere', 'Type', 'Full.context', 'Left_context_POS', 'Right_context_POS')
data[cols] <- lapply(data[cols], factor)

data %>% filter(Center=='как' | Center=='а-ля') -> kak_a_la
data %>% filter(Center=='как' | Center=='аки') -> kak_aki
data %>% filter(Center=='как' | Center=='подобно') -> kak_podobno
data %>% filter(Center=='как' | Center=='словно') -> kak_slovno
data %>% filter(Center=='как' | Center=='будто') -> kak_budto
```

###Биномиальные тесты
####Sphere
```{r}
budto_slovno <- data
budto_slovno$Center <- gsub("будто", 1, budto_slovno$Center)
budto_slovno$Center <- gsub("словно", 1, budto_slovno$Center)
budto_slovno$Center <- gsub("аки", 0, budto_slovno$Center)
budto_slovno$Center <- gsub("а-ля", 0, budto_slovno$Center)
budto_slovno$Center <- gsub("как", 0, budto_slovno$Center)
budto_slovno$Center <- gsub("подобно", 0, budto_slovno$Center)

belles_lettres <- budto_slovno[budto_slovno$Sphere=="художественная",]

total <- nrow(belles_lettres)
nbudto_slovno <- nrow(belles_lettres[belles_lettres$Center==1,]) # number of successes

binom.test(nbudto_slovno, total)
```
####Type
```{r}
belles_lettres2 <- budto_slovno[budto_slovno$Type=="художественный",]

total <- nrow(belles_lettres2)
nbudto_slovno <- nrow(belles_lettres2[belles_lettres2$Center==1,]) # number of successes

binom.test(nbudto_slovno, total)
```

####"Аки" in the past 

```{r}
aki <- data
aki$Center <- gsub("будто", 0, budto_slovno$Center)
aki$Center <- gsub("словно", 0, budto_slovno$Center)
aki$Center <- gsub("аки", 1, budto_slovno$Center)
aki$Center <- gsub("а-ля", 0, budto_slovno$Center)
aki$Center <- gsub("как", 0, budto_slovno$Center)
aki$Center <- gsub("подобно", 0, budto_slovno$Center)

old_texts <- aki[aki$Created<=1900,]
total <- nrow(old_texts)
naki <- nrow(old_texts[old_texts$Center==1,]) # number of successes

binom.test(naki, total)
```


###Хи-квадрат

```{r}
#tab <- table(data$Center, data$Created)
#tab

data <- data %>% mutate(Century = ifelse(Created >= 1900, "20 век", "до 20 века"))

tab <- table(data$Center, data$Century)
tab

prop.table(tab) * 100

chisq.test(data$Center, data$Century)
res <- chisq.test(data$Center, data$Century)

res$expected
res$observed

sum((res$expected - res$observed) ** 2 / res$expected)
```

###Логистическая регрессия

```{r}
fit1 <- glm(Center ~ Sphere + Type + Right_context_POS + Left_context_POS, data = kak_a_la, family = "binomial")
summary(fit1)
```
```{r}
Sphere+ Type + Created + Right_context_POS + Left_context_POS
```

```{r}
fit2 <- glm(Center ~ Sphere + Type + Right_context_POS + Left_context_POS
, data = kak_aki, family = "binomial")
summary(fit2)
```

```{r}
fit3 <- glm(Center ~ Sphere + Type + Right_context_POS + Left_context_POS, data = kak_podobno, family = "binomial")
summary(fit3)
```

```{r}
fit4 <- glm(Center ~ Sphere + Type + Right_context_POS + Left_context_POS, data = kak_slovno, family = "binomial")
summary(fit4)
```

```{r}
fit5 <- glm(Center ~ Sphere + Type + Right_context_POS + Left_context_POS, data = kak_budto, family = "binomial")
summary(fit5)
```