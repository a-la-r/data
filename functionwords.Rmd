---
title: 'Russian comparative function words'
author: "Кирилл Коновалов, Пётр Фильченков"
date: "12/06/2020"
output:
  html_notebook: default
  html_document: default
---

Предмет исследования: распределение ...   
Материал исследования: примеры из Национального Корпуса Русского Языка.

Факторы, которые рассматриваются как возможно влияющие на выбор слова (независимые переменнные):

- регистр речи (письменный, устный);   
- жанр текста (художественный, нехудожественный);   
- часть речи слова, стоящая слева от анализируемого;  
- часть речи слова, стоящая справа от анализируемого;   
- время создания текста (по десятилетиям). 

Нулевой гипотезой является предположение о том, что ... 

В результате получено ... .  ... . Данные представлены в файле ___.csv и проиллюстрированы в графиках.

```{r}
install.packages("tidyverse")
library("tidyverse")
library("dplyr")
```

```{r}
urlfile="https://raw.githubusercontent.com/a-la-r/data/master/df_250_wr.csv"
data<-read.csv(url(urlfile), sep = ";")

cols <- c('Left.context', 'Center', 'Right.context', 'Created', 'Sphere', 'Type', 'Full.context', 'Left_context_POS', 'Right_context_POS')
data[cols] <- lapply(data[cols], factor)
```

```{r}
head(data)
```

```{r}
data %>%
  ggplot(aes(Sphere, fill = Sphere)) + 
  geom_bar() +
  theme_bw() + 
  facet_wrap(~Center) +
  theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank())
```

```{r}
data %>%
  ggplot(aes(Type, fill = Type)) + 
  geom_bar() +
  theme_bw() +
  facet_wrap(~Center) +
  theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank())
```

```{r}
data %>%
  ggplot(aes(Created, fill = Center)) + 
  geom_bar() +
  theme_bw() +
  facet_wrap(~Center) 
 # theme(axis.text.x=element_blank(),
       # axis.ticks.x=element_blank())
```

```{r}
data %>%
  ggplot(aes(Left_context_POS, fill = Left_context_POS)) + 
  geom_bar() +
  theme_bw() +
  facet_wrap(~Center) +
  theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank())
```

```{r}
data %>%
  ggplot(aes(Right_context_POS, fill = Right_context_POS)) + 
  geom_bar() +
  theme_bw() +
  facet_wrap(~Center) +
  theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank())
```

###Предобработка датасета

```{r}
data %>% filter(Center=='как' | Center=='а-ля') -> kak_a_la
data %>% filter(Center=='как' | Center=='аки') -> kak_aki
data %>% filter(Center=='как' | Center=='подобно') -> kak_podobno
data %>% filter(Center=='как' | Center=='словно') -> kak_slovno
data %>% filter(Center=='как' | Center=='будто') -> kak_budto

#kak_a_la_split <- createDataPartition(y = kak_a_la$Center, p = 0.75, list = FALSE)
smp_size <- floor(0.75 * nrow(kak_a_la))
set.seed(123)

train_ind_kak_a_la <- sample(seq_len(nrow(kak_a_la)), size = smp_size)
train_kak_a_la <- kak_a_la[train_ind_kak_a_la, ]
test_kak_a_la <- kak_a_la[-train_ind_kak_a_la, ]
rownames(train_kak_a_la) <- NULL
rownames(test_kak_a_la) <- NULL


train_ind_kak_aki <- sample(seq_len(nrow(kak_aki)), size = smp_size)
train_kak_aki <- kak_aki[train_ind_kak_aki, ]
test_kak_aki <- kak_aki[-train_ind_kak_aki, ]
rownames(train_kak_aki) <- NULL
rownames(test_kak_aki) <- NULL

train_ind_kak_podobno <- sample(seq_len(nrow(kak_podobno)), size = smp_size)
train_kak_podobno <- kak_podobno[train_ind_kak_podobno, ]
test_kak_podobno <- kak_podobno[-train_ind_kak_podobno, ]
rownames(train_kak_podobno) <- NULL
rownames(test_kak_podobno) <- NULL

train_ind_kak_slovno <- sample(seq_len(nrow(kak_slovno)), size = smp_size)
train_kak_slovno <- kak_slovno[train_ind_kak_slovno, ]
test_kak_slovno <- kak_slovno[-train_ind_kak_slovno, ]
rownames(train_kak_slovno) <- NULL
rownames(test_kak_slovno) <- NULL

train_ind_kak_budto <- sample(seq_len(nrow(kak_budto)), size = smp_size)
train_kak_budto <- kak_a_la[train_ind_kak_budto, ]
test_kak_budto <- kak_a_la[-train_ind_kak_budto, ]
rownames(train_kak_budto) <- NULL
rownames(test_kak_budto) <- NULL

```

###Логистическая регрессия

```{r}
fit1 <- glm(Center ~ Sphere + Type + Created + Right_context_POS + Left_context_POS, data = train_kak_a_la, family = "binomial")
summary(fit1)
```

```{r}
fit2 <- glm(Center ~ Sphere + Type + Created + Right_context_POS + Left_context_POS, data = train_kak_aki, family = "binomial")
summary(fit2)
```

```{r}
fit3 <- glm(Center ~ Sphere + Type + Created + Right_context_POS + Left_context_POS, data = train_kak_podobno, family = "binomial")
summary(fit3)
```

```{r}
fit4 <- glm(Center ~ Sphere + Type + Created + Right_context_POS + Left_context_POS, data = train_kak_slovno, family = "binomial")
summary(fit4)
```

```{r}
fit5 <- glm(Center ~ Sphere + Type + Created + Right_context_POS + Left_context_POS, data = train_kak_budto, family = "binomial")
summary(fit5)
```