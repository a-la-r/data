---
title: 'Russian comparative function words'
author: "Кирилл Коновалов, Пётр Фильченков"
date: "12/06/2020"
output:
  html_notebook: default
  html_document: default
---

Предмет исследования: распределение ...   
Материал исследования: примеры из Национального Корпуса Русского Языка.

Факторы, которые рассматриваются как возможно влияющие на выбор слова (независимые переменнные):

- регистр речи (письменный, устный);   
- жанр текста (художественный, нехудожественный);   
- часть речи слова, стоящая слева от анализируемого;  
- часть речи слова, стоящая справа от анализируемого;   
- время создания текста (по десятилетиям). 

Нулевой гипотезой является предположение о том, что ... 

В результате получено ... .  ... . Данные представлены в файле ___.csv и проиллюстрированы в графиках.


Hypotheses to be tested:
"будто", "словно", "а-ля", "аки", "подобно"

"будто" and "словно" occur more often in bellse-lettres texts (binominal test for belles-lettres subcorpus, where "будто" is 1, and other words are 0. binominal test for belles-lettres subcorpus, where "словно" is 1, and other words are 0. )
"как", "подобно" have even distribution in texts of all genres (just look at the data plot)
"а-ля" and "аки" tend to occur more often in the past ()


```{r}
install.packages("tidyverse")
library(tidyverse)
library(dplyr)
```

```{r}
urlfile="https://raw.githubusercontent.com/a-la-r/data/master/df_250_wr.csv"
data<-read.csv(url(urlfile), sep = ";", encoding='UTF-8')

cols <- c('Left.context', 'Center', 'Right.context', 'Created', 'Sphere', 'Type', 'Full.context', 'Left_context_POS', 'Right_context_POS')
#data[cols] <- lapply(data[cols], factor)
```

```{r}
head(data)
```

```{r}
data %>%
  ggplot(aes(Sphere, fill = Sphere)) + 
  geom_bar() +
  theme_bw() + 
  facet_wrap(~Center) +
  theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank())
```

```{r}
data %>%
  ggplot(aes(Type, fill = Type)) + 
  geom_bar() +
  theme_bw() +
  facet_wrap(~Center) +
  theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank())
```

```{r}
data %>%
  ggplot(aes(Created, fill = Center)) + 
  geom_bar() +
  theme_bw() +
  facet_wrap(~Center) 
 # theme(axis.text.x=element_blank(),
       # axis.ticks.x=element_blank())
```

```{r}
data %>%
  ggplot(aes(Left_context_POS, fill = Left_context_POS)) + 
  geom_bar() +
  theme_bw() +
  facet_wrap(~Center) +
  theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank())
```

```{r}
data %>%
  ggplot(aes(Right_context_POS, fill = Right_context_POS)) + 
  geom_bar() +
  theme_bw() +
  facet_wrap(~Center) +
  theme(axis.text.x=element_blank(),
        axis.ticks.x=element_blank())
```

###Предобработка датасета

```{r}
data %>% filter(Center=='как' | Center=='а-ля') -> kak_a_la
data %>% filter(Center=='как' | Center=='аки') -> kak_aki
data %>% filter(Center=='как' | Center=='подобно') -> kak_podobno
data %>% filter(Center=='как' | Center=='словно') -> kak_slovno
data %>% filter(Center=='как' | Center=='будто') -> kak_budto

```

###Логистическая регрессия

```{r}
fit1 <- glm(Center ~ Sphere + Type + Created + Right_context_POS + Left_context_POS, data = train_kak_a_la, family = "binomial")
summary(fit1)
```

```{r}
fit2 <- glm(Center ~ Sphere + Type + Created + Right_context_POS + Left_context_POS, data = train_kak_aki, family = "binomial")
summary(fit2)
```

```{r}
fit3 <- glm(Center ~ Sphere + Type + Created + Right_context_POS + Left_context_POS, data = train_kak_podobno, family = "binomial")
summary(fit3)
```

```{r}
fit4 <- glm(Center ~ Sphere + Type + Created + Right_context_POS + Left_context_POS, data = train_kak_slovno, family = "binomial")
summary(fit4)
```

```{r}
fit5 <- glm(Center ~ Sphere + Type + Created + Right_context_POS + Left_context_POS, data = train_kak_budto, family = "binomial")
summary(fit5)
```